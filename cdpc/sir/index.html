<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador Modelo SIR - Actividad Did√°ctica</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Google Fonts: Space Mono for that retro data feel -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .data-font { font-family: 'Space Mono', monospace; }
        input[type=range] {
            -webkit-appearance: none; 
            background: transparent; 
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #3b82f6;
            margin-top: -6px;
            cursor: pointer;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 4px;
            cursor: pointer;
            background: #e5e7eb;
            border-radius: 2px;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 h-screen flex flex-col overflow-hidden">

    <!-- Header -->
    <header class="bg-slate-900 text-white p-4 shadow-md flex justify-between items-center shrink-0 z-10">
        <div>
            <h1 class="text-xl font-bold tracking-wide">MODELO <span class="text-blue-400">S</span><span class="text-red-500">I</span><span class="text-green-500">R</span></h1>
            <p class="text-xs text-slate-400">Simulaci√≥n interactiva de epidemias</p>
        </div>
        <div class="text-right hidden sm:block">
            <div class="text-xs text-slate-400">Basado en Actividad 3</div>
            <div class="text-xs font-mono text-yellow-400">N = S + I + R</div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex-1 flex flex-col lg:flex-row overflow-hidden">
        
        <!-- Controls Sidebar -->
        <aside class="w-full lg:w-80 bg-white border-r border-slate-200 p-5 overflow-y-auto shrink-0 shadow-lg z-10 flex flex-col gap-6">
            
            <!-- Scenarios -->
            <div class="space-y-2">
                <h3 class="text-xs font-bold uppercase text-slate-400 tracking-wider">Escenarios del PDF</h3>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="loadScenario('base')" class="px-3 py-2 text-xs font-semibold bg-slate-100 hover:bg-slate-200 text-slate-700 rounded transition text-left">1. Base (Sin freno)</button>
                    <button onclick="loadScenario('flatten')" class="px-3 py-2 text-xs font-semibold bg-slate-100 hover:bg-slate-200 text-slate-700 rounded transition text-left">2. Aplanar Curva</button>
                    <button onclick="loadScenario('lockdown')" class="px-3 py-2 text-xs font-semibold bg-slate-100 hover:bg-slate-200 text-slate-700 rounded transition text-left">3. Confinamiento (D√≠a 7)</button>
                    <button onclick="loadScenario('secondWave')" class="px-3 py-2 text-xs font-semibold bg-slate-100 hover:bg-slate-200 text-slate-700 rounded transition text-left">4. Segunda Ola</button>
                </div>
            </div>

            <hr class="border-slate-100">

            <!-- Parameters -->
            <div class="space-y-6">
                <h3 class="text-xs font-bold uppercase text-slate-400 tracking-wider">Par√°metros Iniciales</h3>
                
                <!-- Beta Control -->
                <div>
                    <div class="flex justify-between mb-1">
                        <label class="text-sm font-semibold text-blue-700">Tasa de Contagio (Œ≤)</label>
                        <span id="betaVal" class="data-font text-sm font-bold">0.0005</span>
                    </div>
                    <input type="range" id="betaSlider" min="0.0001" max="0.0030" step="0.0001" value="0.0005" class="w-full" oninput="updateParams()">
                    <p class="text-xs text-slate-500 mt-1">Probabilidad de transmisi√≥n por contacto.</p>
                </div>

                <!-- Gamma Control -->
                <div>
                    <div class="flex justify-between mb-1">
                        <label class="text-sm font-semibold text-green-700">Tasa Recuperaci√≥n (Œ≥)</label>
                        <span id="gammaVal" class="data-font text-sm font-bold">0.2</span>
                    </div>
                    <input type="range" id="gammaSlider" min="0.05" max="0.5" step="0.01" value="0.2" class="w-full" oninput="updateParams()">
                    <p class="text-xs text-slate-500 mt-1">1/Œ≥ = D√≠as siendo infeccioso (<span id="daysInfectious">5</span> d√≠as).</p>
                </div>

                <!-- Initial Infected -->
                <div>
                     <div class="flex justify-between mb-1">
                        <label class="text-sm font-semibold text-red-700">Infectados Iniciales (I‚ÇÄ)</label>
                        <span id="initIVal" class="data-font text-sm font-bold">1</span>
                    </div>
                    <input type="range" id="initISlider" min="1" max="100" step="1" value="1" class="w-full" oninput="updateParams()">
                </div>
            </div>

            <!-- Interventions Section -->
            <div class="bg-yellow-50 border border-yellow-200 rounded p-3 text-sm">
                <div class="flex items-center justify-between cursor-pointer" onclick="toggleInterventionPanel()">
                    <h3 class="font-bold text-yellow-800">üõ†Ô∏è Intervenci√≥n (Confinamiento)</h3>
                    <span id="interventionToggle">‚ñº</span>
                </div>
                <div id="interventionControls" class="mt-3 space-y-3 hidden">
                    <div class="flex items-center gap-2">
                        <input type="checkbox" id="enableIntervention" onchange="updateParams()" class="w-4 h-4 text-blue-600 rounded">
                        <label for="enableIntervention" class="font-medium text-slate-700">Activar medida</label>
                    </div>
                    <div>
                        <label class="block text-xs text-slate-500">D√≠a de inicio</label>
                        <input type="number" id="intDay" value="7" class="w-full border rounded px-2 py-1 text-sm data-font" oninput="updateParams()">
                    </div>
                    <div>
                        <label class="block text-xs text-slate-500">Nuevo Œ≤ (Beta reducido)</label>
                        <input type="number" id="intBeta" value="0.0002" step="0.0001" class="w-full border rounded px-2 py-1 text-sm data-font" oninput="updateParams()">
                    </div>
                    <div class="pt-2 border-t border-yellow-200">
                         <div class="flex items-center gap-2">
                            <input type="checkbox" id="enableDeescalation" onchange="updateParams()" class="w-4 h-4 text-blue-600 rounded">
                            <label for="enableDeescalation" class="font-medium text-slate-700">Desescalada (2¬™ Ola)</label>
                        </div>
                         <div id="deescalationControls" class="mt-2 hidden">
                            <label class="block text-xs text-slate-500">D√≠a fin confinamiento</label>
                            <input type="number" id="deesDay" value="45" class="w-full border rounded px-2 py-1 text-sm data-font" oninput="updateParams()">
                            <label class="block text-xs text-slate-500 mt-1">Œ≤ al salir</label>
                            <input type="number" id="deesBeta" value="0.0008" step="
